{{< include _extensions/_maths_shortcuts.qmd >}}

```{r}
#| include: false
library(tidyverse)
library(kableExtra)
library(gt)
```


## Ordinal data

Consider the case of analysing multivariate data $\mathbf y = (y_{1}, \ldots, y_{p})^\top$, where each item $y_{i}$ is an ordinal random variable with $m_i$ categories, $i=1,\dots,p$.
Let $\mathcal R = \{ \mathbf c = (c_1,\dots, c_p)^\top \mid c_i \in \{1,\dots, m_i\}\}$ be the set of all possible response patterns, and let $R=\prod_{i} m_i$ be the cardinality of this set.
The joint probability of observing a response pattern $\mathbf c_r \in \mathcal R$ is given by
$$
\pi_r = \Pr(\mathbf y = \mathbf c_r) = \Pr(y_1 = \mathbf c_{r1}, \ldots, y_p = \mathbf c_{rp}), \hspace{2em} r = 1, \ldots, R,
$$
with $\sum_r \pi_R = 1$.
Collect all response probabilities into the vector $\boldsymbol \pi = (\pi_1, \ldots, \pi_R)^\top \in [0,1]^R$.
An example with $p=3$, $m_1=2$, and $m_2=m_3=3$ is given below.
In total, there are $R=2 \times 3 \times 3 = 18$ response patterns as shown in @tbl-response-patterns.

```{r}
#| include: false

tab_rp <-
  expand_grid(
    y1 = 1:2,
    y2 = 1:3,
    y3 = 1:3
  ) |> 
  unite("pattern", everything(), sep = "", remove = FALSE) |>
  mutate(r = row_number()) |>
  select(r, starts_with("y"), pattern)
```

::: {#tbl-response-patterns layout-ncol=2}

```{r}
#| html-table-processing: none
#| echo: false
tab_rp |>
  slice(1:9) |>
  gt() |>
  cols_label(
    r = md("$r$"),
    y1 = md("$y_1$"),
    y2 = md("$y_2$"),
    y3 = md("$y_3$"),
    pattern = "Pattern"
  ) |>
  tab_options(table.width = "80%")
```

```{r}
#| html-table-processing: none
#| echo: false
tab_rp |>
  slice(-(1:9)) |>
  gt() |>
  cols_label(
    r = md("$r$"),
    y1 = md("$y_1$"),
    y2 = md("$y_2$"),
    y3 = md("$y_3$"),
    pattern = "Pattern"
  ) |>
  tab_options(table.width = "80%")
```

Response patterns for $p=3$ and $m_1=2$, $m_2=3$, and $m_3=3$.
:::


Marginally, each $y_i$ can be viewed as a multinoulli random variable with event probabilities $\pi_{ik} = \Pr(y_i = k)$.



## Confirmatory factor analysis

## Parameter estimation

## Distribution of residuals

## Wald type tests

## Pearson type tests

## General GOF tests

## Estimation of degrees of freedom