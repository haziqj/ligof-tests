<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.7.31">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="keywords" content="Ordinal data, Confirmatory factor analysis, Limited information, Goodness-of-fit tests">

    <title>Limited information goodness-of-fit tests for ordinal factor models</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      html { -webkit-text-size-adjust: 100%; }
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      /* CSS for citations */
      div.csl-bib-body { }
      div.csl-entry {
        clear: both;
        margin-bottom: 0em;
      }
      .hanging-indent div.csl-entry {
        margin-left:2em;
        text-indent:-2em;
      }
      div.csl-left-margin {
        min-width:2em;
        float:left;
      }
      div.csl-right-inline {
        margin-left:2em;
        padding-left:1em;
      }
      div.csl-indent {
        margin-left: 2em;
      }    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-4061d95a898dc327f84b821d0e9ae8ea.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script> 
      <meta name="citation_title" content="Limited information goodness-of-fit tests for ordinal factor models">
<meta name="citation_abstract" content="Limited information approaches overcome sparsity issues and computational challenges in traditional goodness-of-fit tests. This paper describes the implementation of LIGOF tests for ordinal factor models that have been fitted using the `{lavaan}` package in R. The tests are computationally efficient and reliable, and adapted to suit whichever parameter estimation procedure was used to fit the model. The implementation is available as an R package called `{lavaan.ligof}`.
">
<meta name="citation_keywords" content="Ordinal data,Confirmatory factor analysis,Limited information,Goodness-of-fit tests">
<meta name="citation_author" content="Haziq Jamil">
<meta name="citation_publication_date" content="2025">
<meta name="citation_cover_date" content="2025">
<meta name="citation_year" content="2025">
<meta name="citation_fulltext_html_url" content="https://haziqj.ml/ligof-tests">
<meta name="citation_language" content="en">
<meta name="citation_journal_title" content="Manuscript in preparation">
<meta name="citation_reference" content="citation_title=Categorical data analysis;,citation_author=Alan Agresti;,citation_publication_date=2002;,citation_cover_date=2002;,citation_year=2002;,citation_isbn=978-0-471-36093-3;,citation_language=en-US;,citation_series_title=Wiley series in probability and statistics;">
<meta name="citation_reference" content="citation_title=A goodness of fit test for sparse 2p contingency tables;,citation_author=David J Bartholomew;,citation_author=Shing On Leung;,citation_publication_date=2002;,citation_cover_date=2002;,citation_year=2002;,citation_issue=1;,citation_volume=55;,citation_journal_title=British journal of mathematical and statistical psychology;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=Limited-information goodness-of-fit testing of item response theory models for sparse 2 tables;,citation_abstract=Bartholomew and Leung proposed a limited-information goodness-of-fit test statistic (Y) for models fitted to sparse 2P contingency tables. The null distribution of Y was approximated using a chi-squared distribution by matching moments. The moments were derived under the assumption that the model parameters were known in advance and it was conjectured that the approximation would also be appropriate when the parameters were to be estimated. Using maximum likelihood estimation of the two-parameter logistic item response theory model, we show that the effect of parameter estimation on the distribution of Y is too large to be ignored. Consequently, we derive the asymptotic moments of Y for maximum likelihood estimation. We show using a simulation study that when the null distribution of Y is approximated using moments that take into account the effect of estimation, Y becomes a very useful statistic to assess the overall goodness of fit of models fitted to sparse 2P tables.;,citation_author=Li. Cai;,citation_author=Albert. Maydeu-Olivares;,citation_author=Donna L. Coffman;,citation_author=David. Thissen;,citation_publication_date=2006;,citation_cover_date=2006;,citation_year=2006;,citation_issue=1;,citation_doi=10.1348/000711005X66419;,citation_issn=2044-8317;,citation_volume=59;,citation_language=en-US;,citation_journal_title=British Journal of Mathematical and Statistical Psychology;">
<meta name="citation_reference" content="citation_title=Limited-information goodness-of-fit testing of hierarchical item factor models;,citation_abstract=In applications of item response theory, assessment of model fit is a critical issue. Recently, limited-information goodness-of-fit testing has received increased attention in the psychometrics literature. In contrast to full-information test statistics such as Pearson’s X(2) or the likelihood ratio G(2) , these limited-information tests utilize lower-order marginal tables rather than the full contingency table. A notable example is Maydeu-Olivares and colleagues’M2 family of statistics based on univariate and bivariate margins. When the contingency table is sparse, tests based on M2 retain better Type I error rate control than the full-information tests and can be more powerful. While in principle the M2 statistic can be extended to test hierarchical multidimensional item factor models (e.g., bifactor and testlet models), the computation is non-trivial. To obtain M2 , a researcher often has to obtain (many thousands of) marginal probabilities, derivatives, and weights. Each of these must be approximated with high-dimensional numerical integration. We propose a dimension reduction method that can take advantage of the hierarchical factor structure so that the integrals can be approximated far more efficiently. We also propose a new test statistic that can be substantially better calibrated and more powerful than the original M2 statistic when the test is long and the items are polytomous. We use simulations to demonstrate the performance of our new methods and illustrate their effectiveness with applications to real data.;,citation_author=Li Cai;,citation_author=Mark Hansen;,citation_publication_date=2013-05;,citation_cover_date=2013-05;,citation_year=2013;,citation_issue=2;,citation_doi=10.1111/j.2044-8317.2012.02050.x;,citation_issn=2044-8317;,citation_pmid=22642552;,citation_volume=66;,citation_language=en-US;,citation_journal_title=The British Journal of Mathematical and Statistical Psychology;">
<meta name="citation_reference" content="citation_title=A New Statistic for Evaluating Item Response Theory Models for Ordinal Data. CRESST Report 839.;,citation_author=Li Cai;,citation_author=Scott Monroe;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_journal_title=National Center for Research on Evaluation, Standards, and Student Testing (CRESST);,citation_publisher=ERIC;">
<meta name="citation_reference" content="citation_title=Mirt: A Multidimensional Item Response Theory Package for the R Environment;,citation_abstract=Item response theory (IRT) is widely used in assessment and evaluation research to explain how participants respond to item level stimuli. Several R packages can be used to estimate the parameters in various IRT models, the most flexible being the ltm (Rizopoulos 2006), eRm (Mair and Hatzinger 2007), and MCMCpack (Martin, Quinn, and Park 2011) packages. However these packages have limitations in that ltm and eRm can only analyze unidimensional IRT models effectively and the exploratory multidimensional extensions available in MCMCpack requires prior understanding of Bayesian estimation convergence diagnostics and are computationally intensive. Most importantly, multidimensional confirmatory item factor analysis methods have not been implemented in any R package. The mirt package was created for estimating multidimensional item response theory parameters for exploratory and confirmatory models by using maximum-likelihood meth- ods. The Gauss-Hermite quadrature method used in traditional EM estimation (e.g., Bock and Aitkin 1981) is presented for exploratory item response models as well as for confirmatory bifactor models (Gibbons and Hedeker 1992). Exploratory and confirmatory models are estimated by a stochastic algorithm described by Cai (2010a,b). Various program comparisons are presented and future directions for the package are discussed.;,citation_author=R. Philip Chalmers;,citation_publication_date=2012-05;,citation_cover_date=2012-05;,citation_year=2012;,citation_doi=10.18637/jss.v048.i06;,citation_issn=1548-7660;,citation_volume=48;,citation_language=en-US;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=Factor analysis of dichotomized variables;,citation_author=Anders Christoffersson;,citation_publication_date=1975;,citation_cover_date=1975;,citation_year=1975;,citation_issue=1;,citation_volume=40;,citation_journal_title=Psychometrika;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Introduction to statistical time series;,citation_author=Wayne A Fuller;,citation_publication_date=2009;,citation_cover_date=2009;,citation_year=2009;">
<meta name="citation_reference" content="citation_title=Intraclass Correlation Values for Planning Group-Randomized Trials in Education;,citation_author=Larry V. Hedges;,citation_author=E. C. Hedberg;,citation_publication_date=2007-03;,citation_cover_date=2007-03;,citation_year=2007;,citation_issue=1;,citation_doi=10.3102/0162373707299706;,citation_volume=29;,citation_journal_title=Educational Evaluation and Policy Analysis;">
<meta name="citation_reference" content="citation_title=Empirical analysis on Rao-Scott first order adjustment for two population homogeneity test based on stratified three-stage cluster sampling with pps;,citation_author=Sunyeong Heo;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_issue=3;,citation_volume=7;,citation_journal_title=Journal of the Chosun Natural Science;,citation_publisher=The Basic Science Institute Chosun University;">
<meta name="citation_reference" content="citation_title=Dcm2: Calculating the M2 model fit statistic for diagnostic classification models;,citation_author=Jeffrey Hoover;,citation_author=W. Jake Thompson;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;">
<meta name="citation_reference" content="citation_title=Pairwise likelihood estimation and limited-information goodness-of-fit test statistics for binary factor analysis models under complex survey sampling;,citation_abstract=This paper discusses estimation and limited-information goodness-of-fit test statistics in factor models for binary data using pairwise likelihood estimation and sampling weights. The paper extends the applicability of pairwise likelihood estimation for factor models with binary data to accommodate complex sampling designs. Additionally, it introduces two key limited-information test statistics: the Pearson chi-squared test and the Wald test. To enhance computational efficiency, the paper introduces modifications to both test statistics. The performance of the estimation and the proposed test statistics under simple random sampling and unequal probability sampling is evaluated using simulated data.;,citation_author=Haziq Jamil;,citation_author=Irini Moustaki;,citation_author=Chris Skinner;,citation_publication_date=2025;,citation_cover_date=2025;,citation_year=2025;,citation_issue=1;,citation_doi=10.1111/bmsp.12358;,citation_issn=2044-8317;,citation_volume=78;,citation_language=en-US;,citation_journal_title=British Journal of Mathematical and Statistical Psychology;">
<meta name="citation_reference" content="citation_title=A General Family of Limited Information Goodness-of-Fit Statistics for Multinomial Data;,citation_abstract=Maydeu-Olivares and Joe (J. Am. Stat. Assoc. 100:1009–1020, 2005; Psychometrika 71:713–732, 2006) introduced classes of chi-square tests for (sparse) multidimensional multinomial data based on low-order marginal proportions. Our extension provides general conditions under which quadratic forms in linear functions of cell residuals are asymptotically chi-square. The new statistics need not be based on margins, and can be used for one-dimensional multinomials. We also provide theory that explains why limited information statistics have good power, regardless of sparseness. We show how quadratic-form statistics can be constructed that are more powerful than X2 and yet, have approximate chi-square null distribution in finite samples with large models. Examples with models for truncated count data and binary item response data are used to illustrate the theory.;,citation_author=Harry Joe;,citation_author=Alberto Maydeu-Olivares;,citation_publication_date=2010-09;,citation_cover_date=2010-09;,citation_year=2010;,citation_issue=3;,citation_doi=10.1007/s11336-010-9165-5;,citation_issn=0033-3123, 1860-0980;,citation_volume=75;,citation_language=en-US;,citation_journal_title=Psychometrika;">
<meta name="citation_reference" content="citation_title=Factor Analysis of Ordinal Variables: A Comparison of Three Approaches;,citation_abstract=Theory and methodology for exploratory factor analysis have been well developed for continuous variables. In practice, observed or measured variables are often ordinal. However, ordinality is most often ignored and numbers such as 1, 2, 3, 4, representing ordered categories, are treated as numbers having metric properties, a procedure which is incorrect in several ways. In this article we describe four approaches to factor analysis of ordinal variables which take proper account of ordinality and compare three of them with respect to parameter estimates and fit. The comparison is made both in terms of their relative methodological advantages and in terms of an empirical data example and two generated data examples. In particular, we discuss the issue of how to test the model and to measure model fit.;,citation_author=Karl G. Jöreskog;,citation_author=Irini Moustaki;,citation_publication_date=2001-07;,citation_cover_date=2001-07;,citation_year=2001;,citation_issue=3;,citation_doi=10.1207/S15327906347-387;,citation_issn=0027-3171;,citation_pmid=26751181;,citation_volume=36;,citation_journal_title=Multivariate Behavioral Research;,citation_publisher=Routledge;">
<meta name="citation_reference" content="citation_title=FactorCopula: Factor, bi-factor, second-order and factor tree copula models;,citation_author=Sayed H. Kadhem;,citation_author=Aristidis K. Nikoloulopoulos;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;">
<meta name="citation_reference" content="citation_title=Pairwise Likelihood Ratio Tests and Model Selection Criteria for Structural Equation Models with Ordinal Variables;,citation_abstract=Correlated multivariate ordinal data can be analysed with structural equation models. Parameter estimation has been tackled in the literature using limited-information methods including three-stage least squares and pseudo-likelihood estimation methods such as pairwise maximum likelihood estimation. In this paper, two likelihood ratio test statistics and their asymptotic distributions are derived for testing overall goodness-of-fit and nested models respectively under the estimation framework of pairwise maximum likelihood estimation. Simulation results show a satisfactory performance of type I error and power for the proposed test statistics and also suggest that the performance of the proposed test statistics is similar to that of the test statistics derived under the three-stage diagonally weighted and unweighted least squares. Furthermore, the corresponding, under the pairwise framework, model selection criteria, AIC and BIC, show satisfactory results in selecting the right model in our simulation examples. The derivation of the likelihood ratio test statistics and model selection criteria under the pairwise framework together with pairwise estimation provide a flexible framework for fitting and testing structural equation models for ordinal as well as for other types of data. The test statistics derived and the model selection criteria are used on data on “trust in the police” selected from the 2010 European Social Survey. The proposed test statistics and the model selection criteria have been implemented in the R package lavaan1.;,citation_author=Myrsini Katsikatsou;,citation_author=Irini Moustaki;,citation_publication_date=2016-12;,citation_cover_date=2016-12;,citation_year=2016;,citation_issue=4;,citation_doi=10.1007/s11336-016-9523-z;,citation_issn=0033-3123, 1860-0980;,citation_volume=81;,citation_language=en-US;,citation_journal_title=Psychometrika;">
<meta name="citation_reference" content="citation_title=Confirmatory factor analysis with ordinal data: Comparing robust maximum likelihood and diagonally weighted least squares;,citation_abstract=In confirmatory factor analysis (CFA), the use of maximum likelihood (ML) assumes that the observed indicators follow a continuous and multivariate normal distribution, which is not appropriate for ordinal observed variables. Robust ML (MLR) has been introduced into CFA models when this normality assumption is slightly or moderately violated. Diagonally weighted least squares (WLSMV), on the other hand, is specifically designed for ordinal data. Although WLSMV makes no distributional assumptions about the observed variables, a normal latent distribution underlying each observed categorical variable is instead assumed. A Monte Carlo simulation was carried out to compare the effects of different configurations of latent response distributions, numbers of categories, and sample sizes on model parameter estimates, standard errors, and chi-square test statistics in a correlated two-factor model. The results showed that WLSMV was less biased and more accurate than MLR in estimating the factor loadings across nearly every condition. However, WLSMV yielded moderate overestimation of the interfactor correlations when the sample size was small or/and when the latent distributions were moderately nonnormal. With respect to standard error estimates of the factor loadings and the interfactor correlations, MLR outperformed WLSMV when the latent distributions were nonnormal with a small sample size of N = 200. Finally, the proposed model tended to be over-rejected by chi-square test statistics under both MLR and WLSMV in the condition of small sample size N = 200.;,citation_author=Cheng-Hsien Li;,citation_publication_date=2016-09;,citation_cover_date=2016-09;,citation_year=2016;,citation_issue=3;,citation_doi=10.3758/s13428-015-0619-7;,citation_issn=1554-3528;,citation_volume=48;,citation_language=en-US;,citation_journal_title=Behavior Research Methods;">
<meta name="citation_reference" content="citation_title=Distinguishing Among Paranletric item Response Models for Polychotomous Ordered Data;,citation_abstract=Several item response models have been proposed for fitting Likert-type data. Thissen &amp;amp;amp; Steinberg (1986) classified most of these models into difference models and divide-by-total models. Although they have differ ent mathematical forms, divide-by-total and difference models with the same number of parameters seem to provide very similar fit to the data. The ideal observer method was used to compare two models with the same number of parameters—Samejima’s (1969) graded re sponse model (a difference model) and Thissen &amp; Steinberg’s (1986) extension of Masters’ (1982) partial credit model (a divide-by-total model)—to investigate whether difference models or divide-by-total models should be preferred for fitting Likert-type data. The models were found to be very similar under the condi tions investigated, which included scale lengths from 5 to 25 items (five-option items were used) and calibra tion samples of 250 to 3,000. The results suggest that both models fit approximately equally well in most practical applications. Index terms: graded response model, IRT, Likert scales, partial credit model, poly chotomous models, psychometrics.;,citation_author=Albert Maydeu-Olivares;,citation_author=Fritz Drasgow;,citation_author=Alan D. Mead;,citation_publication_date=1994-09;,citation_cover_date=1994-09;,citation_year=1994;,citation_issue=3;,citation_doi=10.1177/014662169401800305;,citation_issn=0146-6216, 1552-3497;,citation_volume=18;,citation_language=en-US;,citation_journal_title=Applied Psychological Measurement;">
<meta name="citation_reference" content="citation_title=Limited- and full-information estimation and goodness-of-fit testing in 2 n contingency tables: A unified framework;,citation_author=Alberto Maydeu-Olivares;,citation_author=Harry Joe;,citation_publication_date=2005;,citation_cover_date=2005;,citation_year=2005;,citation_issue=471;,citation_volume=100;,citation_journal_title=Journal of the American Statistical Association;,citation_publisher=Taylor &amp;amp;amp; Francis;">
<meta name="citation_reference" content="citation_title=Linear Item Response Theory, Nonlinear Item Response Theory, and Factor Analysis: A Unified Framework;,citation_author=Alberto Maydeu-Olivares;,citation_editor=Roderick P. McDonald;,citation_editor=Albert Maydeu-Olivares;,citation_editor=John J. McArdle;,citation_publication_date=2005;,citation_cover_date=2005;,citation_year=2005;,citation_isbn=978-0-8058-4608-9;,citation_inbook_title=Contemporary Psychometrics: A Festschrift for Roderick P. McDonald;,citation_series_title=Multivariate applications series;">
<meta name="citation_reference" content="citation_title=Limited information goodness-of-fit testing in multidimensional contingency tables;,citation_author=Alberto Maydeu-Olivares;,citation_author=Harry Joe;,citation_publication_date=2006;,citation_cover_date=2006;,citation_year=2006;,citation_issue=4;,citation_volume=71;,citation_journal_title=Psychometrika;,citation_publisher=Springer Nature BV;">
<meta name="citation_reference" content="citation_title=An overview of limited information goodness-of-fit testing in multidimensional contingency tables;,citation_author=Alberto Maydeu-Olivares;,citation_author=Harry Joe;,citation_editor=Kazuo Shigemasu;,citation_editor=A Okada;,citation_editor=T Imaizumi;,citation_editor=T Hoshino;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_conference_title=New Trends in Psychometrics;,citation_conference=Universal Academy Press;">
<meta name="citation_reference" content="citation_title=blavaan: Bayesian Structural Equation Models via Parameter Expansion;,citation_abstract=This article describes blavaan, an R package for estimating Bayesian structural equation models (SEMs) via JAGS and for summarizing the results. It also describes a novel parameter expansion approach for estimating specific types of models with residual covariances, which facilitates estimation of these models in JAGS. The methodology and software are intended to provide users with a general means of estimating Bayesian SEMs, both classical and novel, in a straightforward fashion. Users can estimate Bayesian versions of classical SEMs with lavaan syntax, they can obtain state-of-the-art Bayesian fit measures associated with the models, and they can export JAGS code to modify the SEMs as desired. These features and more are illustrated by example, and the parameter expansion approach is explained in detail.;,citation_author=Edgar C. Merkle;,citation_author=Yves Rosseel;,citation_publication_date=2018-06;,citation_cover_date=2018-06;,citation_year=2018;,citation_doi=10.18637/jss.v085.i04;,citation_issn=1548-7660;,citation_volume=85;,citation_language=en-US;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=Contributions to factor analysis of dichotomous variables;,citation_abstract=A new method is proposed for the factor analysis of dichotomous variables. Similar to the method of Christoffersson this uses information from the first and second order proportions to fit a multiple factor model. Through a transformation into a new set of sample characteristics, the estimation is considerably simplified. A generalized least-squares estimator is proposed, which asymptotically is as efficient as the corresponding estimator of Christoffersson, but which demands less computing time.;,citation_author=Bengt Muthén;,citation_publication_date=1978-12;,citation_cover_date=1978-12;,citation_year=1978;,citation_issue=4;,citation_doi=10.1007/BF02293813;,citation_issn=1860-0980;,citation_volume=43;,citation_language=en-US;,citation_journal_title=Psychometrika;">
<meta name="citation_reference" content="citation_title=Goodness of fit with categorical and other nonnormal variables;,citation_author=Bengt O. Muthén;,citation_publication_date=1993;,citation_cover_date=1993;,citation_year=1993;,citation_volume=154;,citation_journal_title=SAGE Focus Editions;,citation_publisher=Sage Publications;">
<meta name="citation_reference" content="citation_title=Chi-squared tests for analysis of categorical data from complex surveys;,citation_author=Jon N K Rao;,citation_author=Alastair John Scott;,citation_publication_date=1979;,citation_cover_date=1979;,citation_year=1979;,citation_conference_title=Proceedings of the American statistical association, section on survey research methods;">
<meta name="citation_reference" content="citation_title=The Analysis of Categorical Data From Complex Sample Surveys: Chi-Squared Tests for Goodness of Fit and Independence in Two-Way Tables;,citation_abstract=The effect of stratification and clustering on the asymptotic distributions of standard Pearson chi-squared test statistics for goodness of fit (simple hypothesis) and independence in a two-way contingency table, denoted as X&amp;amp;amp;lt;sup&amp;gt;2&amp;lt;/sup&amp;gt; and X<sup>2</sup><sub>1</sub>, respectively, is investigated. It is shown that both X<sup>2</sup> and X<sup>2</sup><sub>1</sub> are asymptotically distributed as weighted sums of independent $\chi$<sub>1</sub><sup>2</sup> random variables. The weights are then related to the familiar design effects (deffs) used by survey samplers. A simple correction to X<sup>2</sup>, which requires only the knowledge of variance estimates (or deffs) for individual cells in the goodness-of-fit problem, is proposed and empirical results on the performance of corrected X<sup>2</sup> provided. Empirical work on X<sup>2</sup><sub>1</sub> indicated that the distortion of nominal significance level is substantially smaller with X<sup>2</sup><sub>1</sub> than with X<sup>2</sup>. Some results under simple models for clustering are also given.;,citation_author=J. N. K. Rao;,citation_author=A. J. Scott;,citation_publication_date=1981;,citation_cover_date=1981;,citation_year=1981;,citation_fulltext_html_url=https://www.jstor.org/stable/2287815;,citation_issue=374;,citation_doi=10.2307/2287815;,citation_issn=0162-1459;,citation_volume=76;,citation_journal_title=Journal of the American Statistical Association;,citation_publisher=[American Statistical Association, Taylor &amp;amp; Francis, Ltd.];">
<meta name="citation_reference" content="citation_title=On chi-squared tests for multiway contingency tables with cell proportions estimated from survey data;,citation_author=Jon N K Rao;,citation_author=Alastair John Scott;,citation_publication_date=1984;,citation_cover_date=1984;,citation_year=1984;,citation_journal_title=The Annals of statistics;,citation_publisher=JSTOR;">
<meta name="citation_reference" content="citation_title=Analysis of residuals for the multionmial item response model;,citation_abstract=Using the item response model as developed on the multinomial distribution, asymptotic variances are obtained for residuals associated with response patterns and first-, and second-order marginal frequencies of manifest variables. When the model does not fit well, an examination of these residuals may reveal the source of the poor fit. Finally, a limited-information test of fit for the model is developed by using residuals defined for the first-, and second-order marginals. Model evaluation based on residuals for these marginals is particularly useful when the response pattern frequencies are sparse.;,citation_author=Mark Reiser;,citation_publication_date=1996-09;,citation_cover_date=1996-09;,citation_year=1996;,citation_issue=3;,citation_doi=10.1007/BF02294552;,citation_issn=1860-0980;,citation_volume=61;,citation_language=en-US;,citation_journal_title=Psychometrika;">
<meta name="citation_reference" content="citation_title=lavaan: An &amp;amp;amp;lt;i&amp;gt;R&amp;lt;/i&amp;gt; Package for Structural Equation Modeling;,citation_abstract=Structural equation modeling (SEM) is a vast field and widely used by many applied researchers in the social and behavioral sciences. Over the years, many software packages for structural equation modeling have been developed, both free and commercial. However, perhaps the best state-of-the-art software packages in this field are still closedsource and/or commercial. The R package lavaan has been developed to provide applied researchers, teachers, and statisticians, a free, fully open-source, but commercial-quality package for latent variable modeling. This paper explains the aims behind the development of the package, gives an overview of its most important features, and provides some examples to illustrate how lavaan works in practice.;,citation_author=Yves Rosseel;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_issue=2;,citation_doi=10.18637/jss.v048.i02;,citation_issn=1548-7660;,citation_volume=48;,citation_language=en-US;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=Factor analysis of dichotomous data.;,citation_author=Hely Salomaa;,citation_publication_date=1992;,citation_cover_date=1992;,citation_year=1992;">
<meta name="citation_reference" content="citation_title=An overview of composite likelihood methods;,citation_author=Cristiano Varin;,citation_author=Nancy Reid;,citation_author=David Firth;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_journal_title=Statistica Sinica;,citation_publisher=JSTOR;">
<meta name="citation_reference" content="citation_title=Composite likelihood estimation in multivariate data analysis;,citation_author=Zhao;,citation_author=Y;,citation_author=H. Joe;,citation_publication_date=2005;,citation_cover_date=2005;,citation_year=2005;,citation_issue=3;,citation_volume=33;,citation_journal_title=Tha Canadian Journal of Statistics;">
</head>

  <body class="quarto-notebook quarto-light">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Article Notebook</h6>

            <a href="./manuscript.qmd" class="btn btn-primary quarto-download-embed" download="manuscript.qmd">Download Source</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Limited information goodness-of-fit tests for ordinal factor models</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Author</div>
          <div class="quarto-title-meta-heading">Affiliations</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author"><a href="https://haziqj.ml">Haziq Jamil</a> <a href="mailto:haziq.jamil@ubd.edu.bn" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0003-3298-1010" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        King Abdullah University of Science and Technology
                      </p>
                    <p class="affiliation">
                        Universiti Brunei Darussalam
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>

    <div>
      <div class="abstract">
        <div class="block-title">Abstract</div>
        <p>Limited information approaches overcome sparsity issues and computational challenges in traditional goodness-of-fit tests. This paper describes the implementation of LIGOF tests for ordinal factor models that have been fitted using the <code>{lavaan}</code> package in R. The tests are computationally efficient and reliable, and adapted to suit whichever parameter estimation procedure was used to fit the model. The implementation is available as an R package called <code>{lavaan.ligof}</code>.</p>
      </div>
    </div>

    <div>
      <div class="keywords">
        <div class="block-title">Keywords</div>
        <p>Ordinal data, Confirmatory factor analysis, Limited information, Goodness-of-fit tests</p>
      </div>
    </div>

    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods"><span class="header-section-number">2</span> Methods</a>
  <ul class="collapse">
  <li><a href="#ordinal-data" id="toc-ordinal-data" class="nav-link" data-scroll-target="#ordinal-data"><span class="header-section-number">2.1</span> Ordinal data</a></li>
  <li><a href="#confirmatory-factor-analysis" id="toc-confirmatory-factor-analysis" class="nav-link" data-scroll-target="#confirmatory-factor-analysis"><span class="header-section-number">2.2</span> Confirmatory factor analysis</a></li>
  <li><a href="#parameter-estimation" id="toc-parameter-estimation" class="nav-link" data-scroll-target="#parameter-estimation"><span class="header-section-number">2.3</span> Parameter estimation</a></li>
  <li><a href="#distribution-of-residuals" id="toc-distribution-of-residuals" class="nav-link" data-scroll-target="#distribution-of-residuals"><span class="header-section-number">2.4</span> Distribution of residuals</a></li>
  <li><a href="#wald-type-tests" id="toc-wald-type-tests" class="nav-link" data-scroll-target="#wald-type-tests"><span class="header-section-number">2.5</span> Wald type tests</a></li>
  <li><a href="#pearson-type-tests" id="toc-pearson-type-tests" class="nav-link" data-scroll-target="#pearson-type-tests"><span class="header-section-number">2.6</span> Pearson type tests</a></li>
  <li><a href="#general-gof-tests" id="toc-general-gof-tests" class="nav-link" data-scroll-target="#general-gof-tests"><span class="header-section-number">2.7</span> General GOF tests</a></li>
  <li><a href="#estimation-of-degrees-of-freedom" id="toc-estimation-of-degrees-of-freedom" class="nav-link" data-scroll-target="#estimation-of-degrees-of-freedom"><span class="header-section-number">2.8</span> Estimation of degrees of freedom</a></li>
  </ul></li>
  <li><a href="#usage" id="toc-usage" class="nav-link" data-scroll-target="#usage"><span class="header-section-number">3</span> Usage</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LaTeX shortcuts </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(readr<span class="sc">::</span><span class="fu">read_file</span>(<span class="st">"_extensions/maths_shortcuts.tex"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
</section>
<section id="methods" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="methods"><span class="header-section-number">2</span> Methods</h2>
<!-- --- -->
<!-- bibliography: refs.bib -->
<!-- csl: apa.csl -->
<!-- --- -->
<!-- {{< include _extensions/_maths_shortcuts.qmd >}} -->
<div class="cell-container"><div class="cell-decorator"><pre>In [1]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'

The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<section id="ordinal-data" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="ordinal-data"><span class="header-section-number">2.1</span> Ordinal data</h3>
<p>Consider the case of analysing multivariate data <span class="math inline">\(\mathbf y = (y_{1}, \ldots, y_{p})^\top\)</span>, where each item <span class="math inline">\(y_{i}\)</span> is an ordinal random variable with <span class="math inline">\(m_i\)</span> categories, <span class="math inline">\(i=1,\dots,p\)</span>. Let <span class="math inline">\(\mathcal R = \{ \mathbf c = (c_1,\dots, c_p)^\top \mid c_i \in \{1,\dots, m_i\}\}\)</span> be the set of all possible response patterns, and let <span class="math inline">\(R=\prod_{i} m_i\)</span> be the cardinality of this set. The joint probability of observing a response pattern <span class="math inline">\(\mathbf c_r \in \mathcal R\)</span> is given by <span class="math display">\[
\pi_r = \Pr(\mathbf y = \mathbf c_r) = \Pr(y_1 = \mathbf c_{r1}, \ldots, y_p = \mathbf c_{rp}), \hspace{2em} r = 1, \ldots, R,
\]</span> with <span class="math inline">\(\sum_r \pi_R = 1\)</span>. Collect all response probabilities into the vector <span class="math inline">\(\boldsymbol \pi = (\pi_1, \ldots, \pi_R)^\top \in [0,1]^R\)</span>. An example with <span class="math inline">\(p=3\)</span>, <span class="math inline">\(m_1=2\)</span>, and <span class="math inline">\(m_2=m_3=3\)</span> is given below. In total, there are <span class="math inline">\(R=2 \times 3 \times 3 = 18\)</span> response patterns as shown in <a href="#tbl-response-patterns" class="quarto-xref">Table&nbsp;1</a>.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [2]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tab_rp <span class="ot">&lt;-</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">y1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y2 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y3 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"pattern"</span>, <span class="fu">everything</span>(), <span class="at">sep =</span> <span class="st">""</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(r, <span class="fu">starts_with</span>(<span class="st">"y"</span>), pattern)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tab_rp <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> <span class="fu">md</span>(<span class="st">"$r$"</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y1 =</span> <span class="fu">md</span>(<span class="st">"$y_1$"</span>),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y2 =</span> <span class="fu">md</span>(<span class="st">"$y_2$"</span>),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y3 =</span> <span class="fu">md</span>(<span class="st">"$y_3$"</span>),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">"Pattern"</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">table.width =</span> <span class="st">"80%"</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>tab_rp <span class="sc">|&gt;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> <span class="fu">md</span>(<span class="st">"$r$"</span>),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y1 =</span> <span class="fu">md</span>(<span class="st">"$y_1$"</span>),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y2 =</span> <span class="fu">md</span>(<span class="st">"$y_2$"</span>),</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y3 =</span> <span class="fu">md</span>(<span class="st">"$y_3$"</span>),</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">"Pattern"</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">table.width =</span> <span class="st">"80%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-response-patterns" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-response-patterns-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Response patterns for <span class="math inline">\(p=3\)</span> with <span class="math inline">\(m_1=2\)</span>, and <span class="math inline">\(m_2=m_3=3\)</span>.
</figcaption>
<div aria-describedby="tbl-response-patterns-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<div class="quarto-layout-row">
<div class="cell-container"><div class="cell-decorator"><pre>In [3]:</pre></div><div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output-display">
<div id="vsokmdluas" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vsokmdluas table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vsokmdluas thead, #vsokmdluas tbody, #vsokmdluas tfoot, #vsokmdluas tr, #vsokmdluas td, #vsokmdluas th {
  border-style: none;
}

#vsokmdluas p {
  margin: 0;
  padding: 0;
}

#vsokmdluas .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 80%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vsokmdluas .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vsokmdluas .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vsokmdluas .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vsokmdluas .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vsokmdluas .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vsokmdluas .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vsokmdluas .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vsokmdluas .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vsokmdluas .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vsokmdluas .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vsokmdluas .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vsokmdluas .gt_spanner_row {
  border-bottom-style: hidden;
}

#vsokmdluas .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vsokmdluas .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vsokmdluas .gt_from_md > :first-child {
  margin-top: 0;
}

#vsokmdluas .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vsokmdluas .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vsokmdluas .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vsokmdluas .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vsokmdluas .gt_row_group_first td {
  border-top-width: 2px;
}

#vsokmdluas .gt_row_group_first th {
  border-top-width: 2px;
}

#vsokmdluas .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vsokmdluas .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vsokmdluas .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vsokmdluas .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vsokmdluas .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vsokmdluas .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vsokmdluas .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vsokmdluas .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vsokmdluas .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vsokmdluas .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vsokmdluas .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vsokmdluas .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vsokmdluas .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vsokmdluas .gt_left {
  text-align: left;
}

#vsokmdluas .gt_center {
  text-align: center;
}

#vsokmdluas .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vsokmdluas .gt_font_normal {
  font-weight: normal;
}

#vsokmdluas .gt_font_bold {
  font-weight: bold;
}

#vsokmdluas .gt_font_italic {
  font-style: italic;
}

#vsokmdluas .gt_super {
  font-size: 65%;
}

#vsokmdluas .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vsokmdluas .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vsokmdluas .gt_indent_1 {
  text-indent: 5px;
}

#vsokmdluas .gt_indent_2 {
  text-indent: 10px;
}

#vsokmdluas .gt_indent_3 {
  text-indent: 15px;
}

#vsokmdluas .gt_indent_4 {
  text-indent: 20px;
}

#vsokmdluas .gt_indent_5 {
  text-indent: 25px;
}

#vsokmdluas .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vsokmdluas div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="r"><span data-qmd-base64="JHIk"><span class="gt_from_md">\(r\)</span></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="y1"><span data-qmd-base64="JHlfMSQ="><span class="gt_from_md">\(y_1\)</span></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="y2"><span data-qmd-base64="JHlfMiQ="><span class="gt_from_md">\(y_2\)</span></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="y3"><span data-qmd-base64="JHlfMyQ="><span class="gt_from_md">\(y_3\)</span></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="pattern">Pattern</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="r" class="gt_row gt_right">1</td>
<td headers="y1" class="gt_row gt_right">1</td>
<td headers="y2" class="gt_row gt_right">1</td>
<td headers="y3" class="gt_row gt_right">1</td>
<td headers="pattern" class="gt_row gt_right">111</td></tr>
    <tr><td headers="r" class="gt_row gt_right">2</td>
<td headers="y1" class="gt_row gt_right">1</td>
<td headers="y2" class="gt_row gt_right">1</td>
<td headers="y3" class="gt_row gt_right">2</td>
<td headers="pattern" class="gt_row gt_right">112</td></tr>
    <tr><td headers="r" class="gt_row gt_right">3</td>
<td headers="y1" class="gt_row gt_right">1</td>
<td headers="y2" class="gt_row gt_right">1</td>
<td headers="y3" class="gt_row gt_right">3</td>
<td headers="pattern" class="gt_row gt_right">113</td></tr>
    <tr><td headers="r" class="gt_row gt_right">4</td>
<td headers="y1" class="gt_row gt_right">1</td>
<td headers="y2" class="gt_row gt_right">2</td>
<td headers="y3" class="gt_row gt_right">1</td>
<td headers="pattern" class="gt_row gt_right">121</td></tr>
    <tr><td headers="r" class="gt_row gt_right">5</td>
<td headers="y1" class="gt_row gt_right">1</td>
<td headers="y2" class="gt_row gt_right">2</td>
<td headers="y3" class="gt_row gt_right">2</td>
<td headers="pattern" class="gt_row gt_right">122</td></tr>
    <tr><td headers="r" class="gt_row gt_right">6</td>
<td headers="y1" class="gt_row gt_right">1</td>
<td headers="y2" class="gt_row gt_right">2</td>
<td headers="y3" class="gt_row gt_right">3</td>
<td headers="pattern" class="gt_row gt_right">123</td></tr>
    <tr><td headers="r" class="gt_row gt_right">7</td>
<td headers="y1" class="gt_row gt_right">1</td>
<td headers="y2" class="gt_row gt_right">3</td>
<td headers="y3" class="gt_row gt_right">1</td>
<td headers="pattern" class="gt_row gt_right">131</td></tr>
    <tr><td headers="r" class="gt_row gt_right">8</td>
<td headers="y1" class="gt_row gt_right">1</td>
<td headers="y2" class="gt_row gt_right">3</td>
<td headers="y3" class="gt_row gt_right">2</td>
<td headers="pattern" class="gt_row gt_right">132</td></tr>
    <tr><td headers="r" class="gt_row gt_right">9</td>
<td headers="y1" class="gt_row gt_right">1</td>
<td headers="y2" class="gt_row gt_right">3</td>
<td headers="y3" class="gt_row gt_right">3</td>
<td headers="pattern" class="gt_row gt_right">133</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [4]:</pre></div><div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output-display">
<div id="nogavjqqce" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nogavjqqce table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nogavjqqce thead, #nogavjqqce tbody, #nogavjqqce tfoot, #nogavjqqce tr, #nogavjqqce td, #nogavjqqce th {
  border-style: none;
}

#nogavjqqce p {
  margin: 0;
  padding: 0;
}

#nogavjqqce .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 80%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nogavjqqce .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nogavjqqce .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nogavjqqce .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nogavjqqce .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nogavjqqce .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nogavjqqce .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nogavjqqce .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nogavjqqce .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nogavjqqce .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nogavjqqce .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nogavjqqce .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nogavjqqce .gt_spanner_row {
  border-bottom-style: hidden;
}

#nogavjqqce .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nogavjqqce .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nogavjqqce .gt_from_md > :first-child {
  margin-top: 0;
}

#nogavjqqce .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nogavjqqce .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nogavjqqce .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nogavjqqce .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nogavjqqce .gt_row_group_first td {
  border-top-width: 2px;
}

#nogavjqqce .gt_row_group_first th {
  border-top-width: 2px;
}

#nogavjqqce .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nogavjqqce .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nogavjqqce .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nogavjqqce .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nogavjqqce .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nogavjqqce .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nogavjqqce .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nogavjqqce .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nogavjqqce .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nogavjqqce .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nogavjqqce .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nogavjqqce .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nogavjqqce .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nogavjqqce .gt_left {
  text-align: left;
}

#nogavjqqce .gt_center {
  text-align: center;
}

#nogavjqqce .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nogavjqqce .gt_font_normal {
  font-weight: normal;
}

#nogavjqqce .gt_font_bold {
  font-weight: bold;
}

#nogavjqqce .gt_font_italic {
  font-style: italic;
}

#nogavjqqce .gt_super {
  font-size: 65%;
}

#nogavjqqce .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nogavjqqce .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nogavjqqce .gt_indent_1 {
  text-indent: 5px;
}

#nogavjqqce .gt_indent_2 {
  text-indent: 10px;
}

#nogavjqqce .gt_indent_3 {
  text-indent: 15px;
}

#nogavjqqce .gt_indent_4 {
  text-indent: 20px;
}

#nogavjqqce .gt_indent_5 {
  text-indent: 25px;
}

#nogavjqqce .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nogavjqqce div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="r"><span data-qmd-base64="JHIk"><span class="gt_from_md">\(r\)</span></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="y1"><span data-qmd-base64="JHlfMSQ="><span class="gt_from_md">\(y_1\)</span></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="y2"><span data-qmd-base64="JHlfMiQ="><span class="gt_from_md">\(y_2\)</span></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="y3"><span data-qmd-base64="JHlfMyQ="><span class="gt_from_md">\(y_3\)</span></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="pattern">Pattern</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="r" class="gt_row gt_right">10</td>
<td headers="y1" class="gt_row gt_right">2</td>
<td headers="y2" class="gt_row gt_right">1</td>
<td headers="y3" class="gt_row gt_right">1</td>
<td headers="pattern" class="gt_row gt_right">211</td></tr>
    <tr><td headers="r" class="gt_row gt_right">11</td>
<td headers="y1" class="gt_row gt_right">2</td>
<td headers="y2" class="gt_row gt_right">1</td>
<td headers="y3" class="gt_row gt_right">2</td>
<td headers="pattern" class="gt_row gt_right">212</td></tr>
    <tr><td headers="r" class="gt_row gt_right">12</td>
<td headers="y1" class="gt_row gt_right">2</td>
<td headers="y2" class="gt_row gt_right">1</td>
<td headers="y3" class="gt_row gt_right">3</td>
<td headers="pattern" class="gt_row gt_right">213</td></tr>
    <tr><td headers="r" class="gt_row gt_right">13</td>
<td headers="y1" class="gt_row gt_right">2</td>
<td headers="y2" class="gt_row gt_right">2</td>
<td headers="y3" class="gt_row gt_right">1</td>
<td headers="pattern" class="gt_row gt_right">221</td></tr>
    <tr><td headers="r" class="gt_row gt_right">14</td>
<td headers="y1" class="gt_row gt_right">2</td>
<td headers="y2" class="gt_row gt_right">2</td>
<td headers="y3" class="gt_row gt_right">2</td>
<td headers="pattern" class="gt_row gt_right">222</td></tr>
    <tr><td headers="r" class="gt_row gt_right">15</td>
<td headers="y1" class="gt_row gt_right">2</td>
<td headers="y2" class="gt_row gt_right">2</td>
<td headers="y3" class="gt_row gt_right">3</td>
<td headers="pattern" class="gt_row gt_right">223</td></tr>
    <tr><td headers="r" class="gt_row gt_right">16</td>
<td headers="y1" class="gt_row gt_right">2</td>
<td headers="y2" class="gt_row gt_right">3</td>
<td headers="y3" class="gt_row gt_right">1</td>
<td headers="pattern" class="gt_row gt_right">231</td></tr>
    <tr><td headers="r" class="gt_row gt_right">17</td>
<td headers="y1" class="gt_row gt_right">2</td>
<td headers="y2" class="gt_row gt_right">3</td>
<td headers="y3" class="gt_row gt_right">2</td>
<td headers="pattern" class="gt_row gt_right">232</td></tr>
    <tr><td headers="r" class="gt_row gt_right">18</td>
<td headers="y1" class="gt_row gt_right">2</td>
<td headers="y2" class="gt_row gt_right">3</td>
<td headers="y3" class="gt_row gt_right">3</td>
<td headers="pattern" class="gt_row gt_right">233</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div></div>
</div>
</div>
</figure>
</div>
<p>Later on we wish to use lower-order residuals to assess the fit of a model to the data, which first requires a description of lower-order moments and its connection to the joint response probabilities. <!-- Let $I_{ik} = [y_i = k]$ be the indicator variable for the event that $y_i$ takes the value $k$, where $[\cdot]$ is the Iverson bracket. --> Marginally, each <span class="math inline">\(y_i\)</span> can be viewed as a multinoulli random variable with event probabilities <span class="math inline">\(\pi^{(i)}_k = \Pr(y_i = k)\)</span>, <span class="math inline">\(k=1,\dots m_i\)</span>, that sum to one. Therefore, this univariate distribution is characterised by its <span class="math inline">\((m_i-1)\)</span> <em>moments</em> <span class="math inline">\(\pi^{(i)}_2,\dots,\pi^{(i)}_{m_i}\)</span>, with the first moment being redundant due to the sum to unity constraint. All univariate moments can be collected into the vector <span class="math inline">\(\dot{\boldsymbol\pi}_1 = (\pi^{(i)}_k)^\top\)</span> whose dimension is <span class="math inline">\(S_1 = \sum_i (m_i-1)\)</span>. In a similar light, the bivariate distribution of <span class="math inline">\((y_i, y_j)\)</span> is characterised by its <span class="math inline">\((m_i-1)(m_j-1)\)</span> <em>joint moments</em> <span class="math inline">\(\pi^{(ij)}_{k,l} = \Pr(y_i = k, y_j = l)\)</span>, <span class="math inline">\(k=2,\dots,m_i\)</span>, <span class="math inline">\(l=2,\dots,m_j\)</span>. Also collect all bivariate moments into the vector <span class="math inline">\(\dot{\boldsymbol\pi}_2 = (\pi^{(ij)}_{k,l})^\top\)</span> whose dimension is <span class="math inline">\(S_2 = \sum_{i&lt;j} (m_i-1)(m_j-1)\)</span>. Finally, denote by <span class="math inline">\(\boldsymbol\pi_2 = (\dot{\boldsymbol\pi}_1^\top, \dot{\boldsymbol\pi}_2^\top)^\top\)</span> the vector of multivariate moments up to order 2, which is a vector of length <span class="math inline">\(S = S_1 + S_2\)</span>.</p>
<p>Because the lower order moments are contained in the higher order moments, the vector <span class="math inline">\(\boldsymbol\pi_2\)</span> can be extracted from the joint probabilities <span class="math inline">\({\boldsymbol\pi}\)</span> via a linear operation <span class="math inline">\({\boldsymbol\pi}_2 = {\mathbf T}_2 {\boldsymbol\pi}\)</span> <span class="citation" data-cites="jamil2025pairwise">(<a href="#ref-jamil2025pairwise" role="doc-biblioref">Jamil et al., 2025</a>)</span>. As an example, continuing from the <span class="math inline">\(p=3\)</span> instance above, the moments for the first variable <span class="math inline">\(y_1\)</span>, <span class="math inline">\(\Pr(y_1=2)\)</span> can be obtained by <em>summing</em> over all joint probabilities whose patterns contain <span class="math inline">\(y_1=2\)</span>. The positions of these joint probabilities in the vector <span class="math inline">\({\boldsymbol\pi}\)</span> are picked up by the first row of the matrix <span class="math inline">\({\mathbf T}_2\)</span>. Similarly, the two bivariate moments of <span class="math inline">\((y_1,y_2)\)</span>, i.e.&nbsp;<span class="math inline">\(\pi^{(12)}_{22}\)</span> and <span class="math inline">\(\pi^{(12)}_{23}\)</span> are obtained by summing over the joint probabilities whose patterns contain <span class="math inline">\(y_1=2\)</span> and <span class="math inline">\(y_2=2\)</span>, and <span class="math inline">\(y_1=2\)</span> and <span class="math inline">\(y_2=3\)</span>, respectively.</p>
<div id="fig-T2-matrix" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-T2-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<div class="cell-container"><div class="cell-decorator"><pre>In [5]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width =</span> <span class="dv">100</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>create_T2_mat <span class="ot">&lt;-</span> <span class="cf">function</span>(m) {</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># m: integer vector of length p, where m[i] = number of categories of variable i</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">length</span>(m)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1) all joint patterns (rows = ∏ m[i], cols = p)</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  patterns <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="fu">rev</span>(<span class="fu">lapply</span>(m, seq_len)), <span class="at">KEEP.OUT.ATTRS =</span> <span class="cn">FALSE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  patterns <span class="ot">&lt;-</span> patterns[, <span class="fu">rev</span>(<span class="fu">seq_len</span>(p))] <span class="co"># reverse to match y1, y2, ...</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  n_pat <span class="ot">&lt;-</span> <span class="fu">nrow</span>(patterns)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2) precompute total number of rows: sum_i (m[i]-1) + sum_{i&lt;j} (m[i]-1)*(m[j]-1)</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  uni_rows <span class="ot">&lt;-</span> <span class="fu">sum</span>(m <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  biv_rows <span class="ot">&lt;-</span> <span class="dv">0</span>L</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(p<span class="dv">-1</span>)) <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>p)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    biv_rows <span class="ot">&lt;-</span> biv_rows <span class="sc">+</span> (m[i]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>(m[j]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  total_rows <span class="ot">&lt;-</span> uni_rows <span class="sc">+</span> biv_rows</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3) allocate</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>L, <span class="at">nrow =</span> total_rows, <span class="at">ncol =</span> n_pat)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  rn  <span class="ot">&lt;-</span> <span class="fu">character</span>(total_rows)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4) fill univariate indicator rows</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="dv">1</span>L</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(p)) {</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(cat <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m[i]) {</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>      out[r, ] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(patterns[[i]] <span class="sc">==</span> cat)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>      rn[r]   <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Y"</span>, i, <span class="st">"="</span>, cat)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>      r       <span class="ot">&lt;-</span> r <span class="sc">+</span> <span class="dv">1</span>L</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 5) fill bivariate indicator rows</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(p<span class="dv">-1</span>)) <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>p) {</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(c1 <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m[i]) <span class="cf">for</span>(c2 <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m[j]) {</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>      out[r, ] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(patterns[[i]] <span class="sc">==</span> c1 <span class="sc">&amp;</span> patterns[[j]] <span class="sc">==</span> c2)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>      rn[r]   <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Y"</span>, i, <span class="st">"="</span>, c1, <span class="st">",Y"</span>, j, <span class="st">"="</span>, c2)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>      r       <span class="ot">&lt;-</span> r <span class="sc">+</span> <span class="dv">1</span>L</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(out) <span class="ot">&lt;-</span> rn</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(out) <span class="ot">&lt;-</span> <span class="fu">apply</span>(patterns, <span class="dv">1</span>, paste0, <span class="at">collapse =</span> <span class="st">""</span>)</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>  out</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="fu">create_T2_mat</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          111 112 113 121 122 123 131 132 133 211 212 213 221 222 223 231 232 233
Y1=2        0   0   0   0   0   0   0   0   0   1   1   1   1   1   1   1   1   1
Y2=2        0   0   0   1   1   1   0   0   0   0   0   0   1   1   1   0   0   0
Y2=3        0   0   0   0   0   0   1   1   1   0   0   0   0   0   0   1   1   1
Y3=2        0   1   0   0   1   0   0   1   0   0   1   0   0   1   0   0   1   0
Y3=3        0   0   1   0   0   1   0   0   1   0   0   1   0   0   1   0   0   1
Y1=2,Y2=2   0   0   0   0   0   0   0   0   0   0   0   0   1   1   1   0   0   0
Y1=2,Y2=3   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   1
Y1=2,Y3=2   0   0   0   0   0   0   0   0   0   0   1   0   0   1   0   0   1   0
Y1=2,Y3=3   0   0   0   0   0   0   0   0   0   0   0   1   0   0   1   0   0   1
Y2=2,Y3=2   0   0   0   0   1   0   0   0   0   0   0   0   0   1   0   0   0   0
Y2=2,Y3=3   0   0   0   0   0   1   0   0   0   0   0   0   0   0   1   0   0   0
Y2=3,Y3=2   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   1   0
Y2=3,Y3=3   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   1</code></pre>
</div>
</div></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-T2-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Matrix <span class="math inline">\({\mathbf T}_2\)</span> for the case of <span class="math inline">\(p=3\)</span> with <span class="math inline">\(m_1=2\)</span>, and <span class="math inline">\(m_2=m_3=3\)</span>.
</figcaption>
</figure>
</div>
<p>Note that this construction of lower-order moments generalises to any order <span class="math inline">\(q \le p\)</span>, but the total number of moments up to order <span class="math inline">\(q\)</span> grows combinatorially in both <span class="math inline">\(p\)</span> and the category counts <span class="math inline">\(m_i\)</span>, yielding design matrices <span class="math inline">\(\mathbf{T}_q\)</span> that can become computationally burdensome. Moreover, although we arbitrarily dropped the first moment in the foregoing construction, the choice of which category to omit is immaterial. This is because category probabilities sum to one, so excluding any one category produces a similar-dimensional parameterisation algebraically equivalent to excluding any other. For further details, consult <span class="citation" data-cites="reiser1996analysis">Reiser (<a href="#ref-reiser1996analysis" role="doc-biblioref">1996</a>)</span> and <span class="citation" data-cites="maydeu2006limited">Maydeu-Olivares &amp; Joe (<a href="#ref-maydeu2006limited" role="doc-biblioref">2006</a>)</span>.</p>
</section>
<section id="confirmatory-factor-analysis" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="confirmatory-factor-analysis"><span class="header-section-number">2.2</span> Confirmatory factor analysis</h3>
</section>
<section id="parameter-estimation" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="parameter-estimation"><span class="header-section-number">2.3</span> Parameter estimation</h3>
</section>
<section id="distribution-of-residuals" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="distribution-of-residuals"><span class="header-section-number">2.4</span> Distribution of residuals</h3>
</section>
<section id="wald-type-tests" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="wald-type-tests"><span class="header-section-number">2.5</span> Wald type tests</h3>
</section>
<section id="pearson-type-tests" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="pearson-type-tests"><span class="header-section-number">2.6</span> Pearson type tests</h3>
</section>
<section id="general-gof-tests" class="level3" data-number="2.7">
<h3 data-number="2.7" class="anchored" data-anchor-id="general-gof-tests"><span class="header-section-number">2.7</span> General GOF tests</h3>
</section>
<section id="estimation-of-degrees-of-freedom" class="level3" data-number="2.8">
<h3 data-number="2.8" class="anchored" data-anchor-id="estimation-of-degrees-of-freedom"><span class="header-section-number">2.8</span> Estimation of degrees of freedom</h3>
</section>
</section>
<section id="usage" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="usage"><span class="header-section-number">3</span> Usage</h2>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-jamil2025pairwise" class="csl-entry" role="listitem">
Jamil, H., Moustaki, I., &amp; Skinner, C. (2025). Pairwise likelihood estimation and limited-information goodness-of-fit test statistics for binary factor analysis models under complex survey sampling. <em>British Journal of Mathematical and Statistical Psychology</em>, <em>78</em>(1), 258–285. <a href="https://doi.org/10.1111/bmsp.12358">https://doi.org/10.1111/bmsp.12358</a>
</div>
<div id="ref-maydeu2006limited" class="csl-entry" role="listitem">
Maydeu-Olivares, A., &amp; Joe, H. (2006). Limited information goodness-of-fit testing in multidimensional contingency tables. <em>Psychometrika</em>, <em>71</em>(4), 713.
</div>
<div id="ref-reiser1996analysis" class="csl-entry" role="listitem">
Reiser, M. (1996). Analysis of residuals for the multionmial item response model. <em>Psychometrika</em>, <em>61</em>(3), 509–528. <a href="https://doi.org/10.1007/BF02294552">https://doi.org/10.1007/BF02294552</a>
</div>
</div>
<!-- ## Appendix {.unnumbered} -->
<!-- {{< include _appendix.qmd >}} -->
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>  </div> <!-- /content --> 
  
</body></html>