% Options for packages loaded elsewhere
% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}
\usepackage{xcolor}
\usepackage{amsmath,amssymb}
\setcounter{secnumdepth}{5}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother


\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother


% definitions for citeproc citations
\NewDocumentCommand\citeproctext{}{}
\NewDocumentCommand\citeproc{mm}{%
  \begingroup\def\citeproctext{#2}\cite{#1}\endgroup}
\makeatletter
 % allow citations to break across lines
 \let\@cite@ofmt\@firstofone
 % avoid brackets around text for \cite:
 \def\@biblabel#1{}
 \def\@cite#1#2{{#1\if@tempswa , #2\fi}}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newenvironment{CSLReferences}[2] % #1 hanging-indent, #2 entry-spacing
 {\begin{list}{}{%
  \setlength{\itemindent}{0pt}
  \setlength{\leftmargin}{0pt}
  \setlength{\parsep}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
   \setlength{\leftmargin}{\cslhangindent}
   \setlength{\itemindent}{-1\cslhangindent}
  \fi
  % set entry spacing
  \setlength{\itemsep}{#2\baselineskip}}}
 {\end{list}}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{\hfill\break\parbox[t]{\linewidth}{\strut\ignorespaces#1\strut}}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}



\setlength{\emergencystretch}{3em} % prevent overfull lines

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}



 


\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
\usepackage{caption}
\usepackage{anyfontsize}
\KOMAoption{captions}{tableheading}
\include{_extensions/maths_shortcuts.tex}
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Limited information goodness-of-fit tests for ordinal factor models},
  pdfkeywords={Ordinal data, Confirmatory factor analysis, Limited
information, Goodness-of-fit tests},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\title{Limited information goodness-of-fit tests for ordinal factor
models}
\author{Haziq Jamil}
\date{}
\begin{document}
\maketitle
\begin{abstract}
Limited information approaches overcome sparsity issues and
computational challenges in traditional goodness-of-fit tests. This
paper describes the implementation of LIGOF tests for ordinal factor
models that have been fitted using the \texttt{\{lavaan\}} package in R.
The tests are computationally efficient and reliable, and adapted to
suit whichever parameter estimation procedure was used to fit the model.
The implementation is available as an R package called
\texttt{\{lavaan.ligof\}}.
\end{abstract}


\section{Introduction}\label{introduction}

\section{Methods}\label{methods}

\subsection{Ordinal data}\label{ordinal-data}

Consider the case of analysing multivariate data
\(\mathbf y = (y_{1}, \ldots, y_{p})^\top\), where each item \(y_{i}\)
is an ordinal random variable with \(m_i\) categories, \(i=1,\dots,p\).
Let
\(\mathcal R = \{ \mathbf c = (c_1,\dots, c_p)^\top \mid c_i \in \{1,\dots, m_i\}\}\)
be the set of all possible response patterns, and let
\(R=\prod_{i} m_i\) be the cardinality of this set. The joint
probability of observing a response pattern
\(\mathbf c_r \in \mathcal R\) is given by \[
\pi_r = \Pr(\mathbf y = \mathbf c_r) = \Pr(y_1 = \mathbf c_{r1}, \ldots, y_p = \mathbf c_{rp}), \hspace{2em} r = 1, \ldots, R,
\] with \(\sum_r \pi_R = 1\). Collect all response probabilities into
the vector
\(\boldsymbol \pi = (\pi_1, \ldots, \pi_R)^\top \in [0,1]^R\). An
example with \(p=3\), \(m_1=2\), and \(m_2=m_3=3\) is given below. In
total, there are \(R=2 \times 3 \times 3 = 18\) response patterns as
shown in Table~\ref{tbl-response-patterns}.

\begin{table}

\caption{\label{tbl-response-patterns}Response patterns for \(p=3\) with
\(m_1=2\), and \(m_2=m_3=3\).}

\begin{minipage}{0.50\linewidth}

\fontsize{12.0pt}{14.4pt}\selectfont
\begin{tabular*}{0.8\linewidth}{@{\extracolsep{\fill}}rrrrr}
\toprule
\(r\) & \(y_1\) & \(y_2\) & \(y_3\) & Pattern \\ 
\midrule\addlinespace[2.5pt]
1 & 1 & 1 & 1 & 111 \\ 
2 & 1 & 1 & 2 & 112 \\ 
3 & 1 & 1 & 3 & 113 \\ 
4 & 1 & 2 & 1 & 121 \\ 
5 & 1 & 2 & 2 & 122 \\ 
6 & 1 & 2 & 3 & 123 \\ 
7 & 1 & 3 & 1 & 131 \\ 
8 & 1 & 3 & 2 & 132 \\ 
9 & 1 & 3 & 3 & 133 \\ 
\bottomrule
\end{tabular*}

\end{minipage}%
%
\begin{minipage}{0.50\linewidth}

\fontsize{12.0pt}{14.4pt}\selectfont
\begin{tabular*}{0.8\linewidth}{@{\extracolsep{\fill}}rrrrr}
\toprule
\(r\) & \(y_1\) & \(y_2\) & \(y_3\) & Pattern \\ 
\midrule\addlinespace[2.5pt]
10 & 2 & 1 & 1 & 211 \\ 
11 & 2 & 1 & 2 & 212 \\ 
12 & 2 & 1 & 3 & 213 \\ 
13 & 2 & 2 & 1 & 221 \\ 
14 & 2 & 2 & 2 & 222 \\ 
15 & 2 & 2 & 3 & 223 \\ 
16 & 2 & 3 & 1 & 231 \\ 
17 & 2 & 3 & 2 & 232 \\ 
18 & 2 & 3 & 3 & 233 \\ 
\bottomrule
\end{tabular*}

\end{minipage}%

\end{table}%

Later on we wish to use lower-order residuals to assess the fit of a
model to the data, which first requires a description of lower-order
moments and its connection to the joint response probabilities.
Marginally, each \(y_i\) can be viewed as a multinoulli random variable
with event probabilities \(\pi^{(i)}_k = \Pr(y_i = k)\),
\(k=1,\dots m_i\), that sum to one. Therefore, this univariate
distribution is characterised by its \((m_i-1)\) \emph{moments}
\(\pi^{(i)}_2,\dots,\pi^{(i)}_{m_i}\), with the first moment being
redundant due to the sum to unity constraint. All univariate moments can
be collected into the vector
\(\dot{\boldsymbol\pi}_1 = (\pi^{(i)}_k)^\top\) whose dimension is
\(S_1 = \sum_i (m_i-1)\). In a similar light, the bivariate distribution
of \((y_i, y_j)\) is characterised by its \((m_i-1)(m_j-1)\) \emph{joint
moments} \(\pi^{(ij)}_{k,l} = \Pr(y_i = k, y_j = l)\),
\(k=2,\dots,m_i\), \(l=2,\dots,m_j\). Also collect all bivariate moments
into the vector \(\dot{\boldsymbol\pi}_2 = (\pi^{(ij)}_{k,l})^\top\)
whose dimension is \(S_2 = \sum_{i<j} (m_i-1)(m_j-1)\). Finally, denote
by \(\boldsymbol\pi_2 = (\dot\bpi_1^\top, \dot\bpi_2^\top)^\top\) the
vector of multivariate moments up to order 2, which is a vector of
length \(S = S_1 + S_2\).

Because the lower order moments are contained in the higher order
moments, the vector \(\boldsymbol\pi_2\) can be extracted from the joint
probabilities \(\bpi\) via a linear operation \(\bpi_2 = \bT_2 \bpi\)
(Jamil et al., 2025). As an example, continuing from the \(p=3\)
instance above, the moments for the first variable \(y_1\),
\(\Pr(y_1=2)\) can be obtained by \emph{summing} over all joint
probabilities whose patterns contain \(y_1=2\). The positions of these
joint probabilities in the vector \(\bpi\) are picked up by the first
row of the matrix \(\bT_2\). Similarly, the two bivariate moments of
\((y_1,y_2)\), i.e.~\(\pi^{(12)}_{22}\) and \(\pi^{(12)}_{23}\) are
obtained by summing over the joint probabilities whose patterns contain
\(y_1=2\) and \(y_2=2\), and \(y_1=2\) and \(y_2=3\), respectively.

\begin{figure}

\centering{

\begin{verbatim}
          111 112 113 121 122 123 131 132 133 211 212 213 221 222 223 231 232 233
Y1=2        0   0   0   0   0   0   0   0   0   1   1   1   1   1   1   1   1   1
Y2=2        0   0   0   1   1   1   0   0   0   0   0   0   1   1   1   0   0   0
Y2=3        0   0   0   0   0   0   1   1   1   0   0   0   0   0   0   1   1   1
Y3=2        0   1   0   0   1   0   0   1   0   0   1   0   0   1   0   0   1   0
Y3=3        0   0   1   0   0   1   0   0   1   0   0   1   0   0   1   0   0   1
Y1=2,Y2=2   0   0   0   0   0   0   0   0   0   0   0   0   1   1   1   0   0   0
Y1=2,Y2=3   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   1
Y1=2,Y3=2   0   0   0   0   0   0   0   0   0   0   1   0   0   1   0   0   1   0
Y1=2,Y3=3   0   0   0   0   0   0   0   0   0   0   0   1   0   0   1   0   0   1
Y2=2,Y3=2   0   0   0   0   1   0   0   0   0   0   0   0   0   1   0   0   0   0
Y2=2,Y3=3   0   0   0   0   0   1   0   0   0   0   0   0   0   0   1   0   0   0
Y2=3,Y3=2   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   1   0
Y2=3,Y3=3   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   1
\end{verbatim}

}

\caption{\label{fig-T2-matrix}Matrix \(\bT_2\) for the case of \(p=3\)
with \(m_1=2\), and \(m_2=m_3=3\).}

\end{figure}%

Note that this construction of lower-order moments generalises to any
order \(q \le p\), but the total number of moments up to order \(q\)
grows combinatorially in both \(p\) and the category counts \(m_i\),
yielding design matrices \(\mathbf{T}_q\) that can become
computationally burdensome. Moreover, although we arbitrarily dropped
the first moment in the foregoing construction, the choice of which
category to omit is immaterial. This is because category probabilities
sum to one, so excluding any one category produces a similar-dimensional
parameterisation algebraically equivalent to excluding any other. For
further details, consult Reiser (1996) and Maydeu-Olivares \& Joe
(2006).

\subsection{Confirmatory factor
analysis}\label{confirmatory-factor-analysis}

\subsection{Parameter estimation}\label{parameter-estimation}

\subsection{Distribution of residuals}\label{distribution-of-residuals}

\subsection{Wald type tests}\label{wald-type-tests}

\subsection{Pearson type tests}\label{pearson-type-tests}

\subsection{General GOF tests}\label{general-gof-tests}

\subsection{Estimation of degrees of
freedom}\label{estimation-of-degrees-of-freedom}

\section{Usage}\label{usage}

\section*{References}\label{references}
\addcontentsline{toc}{section}{References}

\phantomsection\label{refs}
\begin{CSLReferences}{1}{0}
\bibitem[\citeproctext]{ref-jamil2025pairwise}
Jamil, H., Moustaki, I., \& Skinner, C. (2025). Pairwise likelihood
estimation and limited-information goodness-of-fit test statistics for
binary factor analysis models under complex survey sampling.
\emph{British Journal of Mathematical and Statistical Psychology},
\emph{78}(1), 258--285. \url{https://doi.org/10.1111/bmsp.12358}

\bibitem[\citeproctext]{ref-maydeu2006limited}
Maydeu-Olivares, A., \& Joe, H. (2006). Limited information
goodness-of-fit testing in multidimensional contingency tables.
\emph{Psychometrika}, \emph{71}(4), 713.

\bibitem[\citeproctext]{ref-reiser1996analysis}
Reiser, M. (1996). Analysis of residuals for the multionmial item
response model. \emph{Psychometrika}, \emph{61}(3), 509--528.
\url{https://doi.org/10.1007/BF02294552}

\end{CSLReferences}




\end{document}
